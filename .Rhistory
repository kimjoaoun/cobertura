xml2::read_xml("cobertura.xml")
x <- xml2::read_xml("cobertura.xml")
View(x)
xml_attrs(x)
x
x[[2]]
x %>% xml2::as_xml_document()
xml2::as_xml_document(x)
xml2::as_xml_document(x) -> x
x
x[[2]]
xml2::as_list(x)
xml2::as_list(x) -> x
View(x)
x[["coverage"]][["packages"]][["package"]][["classes"]][["class"]][["methods"]][["method"]][["lines"]][["line"]]
x[["coverage"]][["sources"]]
x[["coverage"]][["packages"]][["package"]][["classes"]][["class"]]
x[["coverage"]]
x[["coverage"]] -> n
View(n)
library(dplyr)
n[["packages"]] %>% View()
.[["package"]]
.[["package"]][["classes"]][["class"]]
n[["package"]][["classes"]][["class"]]
n[["packages"]][["package"]][["classes"]]
n[["packages"]][["package"]][["classes"]] -> b
View(b)
b[["class"]]
View(x)
x[["coverage"]]
x$coverage -> m
m$sources
m$packages
x %>% as.character()
library(readr)
readr::read_lines("cobertura.xml")
readr::read_lines("cobertura.xml") -> n
readr::read_lines("cobertura.xml") %>%
stringi::stri_extract('line-rate="\\d{1,}"')
readr::read_lines("cobertura.xml") %>%
stringi::stri_extract(regex ='line-rate="\\d{1,}"')
readr::read_lines("cobertura.xml")[1:2]
readr::read_lines("cobertura.xml")[1]
readr::read_lines("cobertura.xml")[2]
readr::read_lines("cobertura.xml") %>%
dplyr::pull(2) %>%
stringi::stri_extract('line-rate="\\d{1,}"')
readr::read_lines("cobertura.xml") %>%
dplyr::pull(2) %>%
stringi::stri_extract(regex = 'line-rate="\\d{1,}"')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2)
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe()
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract('line-rate="\\d{1,}"')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate="\\d{1,}"')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe()
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate=[:punct:]"\\d{1,}[:punct:]"')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate=[:punct:]".{1,}[:punct:]"')
readr::read_lines("cobertura.xml") %>%
+     tibble::enframe() %>%
+     dplyr::slice(2) %>%
+     dplyr::select(value) %>%
+     tibble::deframe()
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe()
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate=\\".{1,}\\"')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe()
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate=\\".{1,}\\"\\s')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate=\\"\\d{1,20}\\"\\s')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate=\\"\\d{1,20}\\"')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate=\\"\\d{1}\\.\\d{1,20}\\"\\s')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = 'line-rate=\\"\\d{1}\\.\\d{1,20}\\"\\s')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?=line-rate=)\\"\\d{1}\\.\\d{1,20}\\"\\s')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=)\\"\\d{1}\\.\\d{1,20}\\"\\s')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}\\"\\s')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}\\"')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}')
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric()
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 10
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 100
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 100 %>%
round(2)
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 100 %>%
round(1)
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 100 %>%
round()
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 100 %>%
round(.)
readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 100
covr_perc <- readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 100
round(covr_perc)
covr_perc <- readr::read_lines("cobertura.xml") %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
as.numeric() * 100
round(covr_perc, 2)
coverage_percentage <- function(cobertura_path = "cobertura.xml") {
covr_perc <- readr::read_lines(cobertura_path) %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
(as.numeric(.) * 100) %>%
round(2)
}
coverage_percentage()
coverage_percentage <- function(cobertura_path = "cobertura.xml") {
covr_perc <- readr::read_lines(cobertura_path) %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
{as.numeric(.) * 100} %>%
round(2)
}
coverage_percentage()
coverage_percentage <- function(cobertura_path = "cobertura.xml") {
covr_perc <- readr::read_lines(cobertura_path) %>%
tibble::enframe() %>%
dplyr::slice(2) %>%
dplyr::select(value) %>%
tibble::deframe() %>%
stringi::stri_extract(regex = '(?<=line-rate=\\")\\d{1}\\.\\d{1,20}') %>%
{as.numeric(.) * 100} %>%
round(2)
covr_perc
}
coverage_percentage()
coverage_perc = 67
dplyr::if_else(
coverage_perc >= 80 ~ "DarkGreen",
coverage_perc >= 65 ~ "Yellow",
coverage_perc < 65 ~ "Red"
)
dplyr::case_when(
coverage_perc >= 80 ~ "DarkGreen",
coverage_perc >= 65 ~ "Yellow",
coverage_perc < 65 ~ "Red"
)
dplyr::case_when(
coverage_perc < 65 ~ "Red",
coverage_perc >= 65 ~ "Yellow",
coverage_perc >= 80 ~ "DarkGreen"
)
coverage_perc = 81
dplyr::case_when(
coverage_perc < 65 ~ "Red",
coverage_perc >= 65 ~ "Yellow",
coverage_perc >= 80 ~ "DarkGreen"
)
dplyr::case_when(
coverage_perc < 65 ~ "Red",
coverage_perc >= 65 & coverage_perc < 80 ~ "Yellow",
coverage_perc >= 80 ~ "DarkGreen"
)
create_coverage_badge <- function(coverage_perc) {
dplyr::case_when(
coverage_perc < 65 ~ "Red",
coverage_perc >= 65 & coverage_perc < 80 ~ "Yellow",
coverage_perc >= 80 ~ "DarkGreen"
) -> color
glue::glue("{https://img.shields.io/badge/Code%20Coverage-{coverage_perc}%25-{color}}")
}
create_coverage_badge("90")
create_coverage_badge <- function(coverage_perc) {
dplyr::case_when(
coverage_perc < 65 ~ "Red",
coverage_perc >= 65 & coverage_perc < 80 ~ "Yellow",
coverage_perc >= 80 ~ "DarkGreen"
) -> color
glue::glue("https://img.shields.io/badge/Code%20Coverage-{coverage_perc}%25-{color}")
}
create_coverage_badge("90")
xml2::read_html("https://img.shields.io/badge/Code%20Coverage-90%25-DarkGreen")
xml2::read_html("https://img.shields.io/badge/Code%20Coverage-90%25-DarkGreen") -> h
View(h)
xml2::read_html("https://img.shields.io/badge/Code%20Coverage-90%25-DarkGreen") %>% xml2::write_html("badge.svg")
usethis::use_mit_license()
usethis::use_package("xml2")
usethis::use_package("dplyr")
usethis::use_package("tibble")
usethis::use_package("stringi")
usethis::use_package("readr")
usethis::use_testthat()
usethis::use_test("coverage_url")
usethis::use_test("coverage_percentage")
test_that("multiplication works", {
coverage_percentage(testthat::test_path("test_svg", "badge_tst.xml"))
})
library(testthat)
test_that("multiplication works", {
coverage_percentage(testthat::test_path("test_svg", "badge_tst.xml"))
})
testthat::test_path("test_svg", "badge_tst.xml")
fs::file_exists(testthat::test_path("test_svg", "badge_tst.xml"))
getwd()
fs::dir_ls(getwd())
fs::dir_ls()
test_that("Coverage Percentage returns the right value", {
coverage_percentage(testthat::test_path("test_svg", "badge_tst.xml")) -> covr_p
testthat::expect_equal(covr_p, 19.35)
})
fs::file_exists('/home/kimjoaoun/Documentos/projetos/cobertura/tests/testthat/test_svg/badge_tst.xml')
fs::dir_ls("tests/testthat/test_svg/")
fs::dir_ls("tests/")
fs::dir_ls("tests/")
fs::dir_ls("tests/")
fs::dir_ls("tests/test_vsg")
q\
fs::dir_ls("tests/test_svg")
